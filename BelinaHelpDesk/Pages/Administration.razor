@page "/administration"
@using BelinaHelpDesk.Data
@using BelinaHelpDesk.Data.Models
@inherits OwningComponentBase<BelinaHelpDeskService>
@*AuthorizeView control ensures that *@
@*Only users in the Administrators role can view this content*@
<AuthorizeView Roles="Administrators">
    <div>
    <div id="target" style="height: 500px;">
    <SfGrid ID="Grid"
    DataSource="@colHelpDeskTickets"
    AllowPaging="true"
    AllowSorting="true"
    AllowResizing="true"
    AllowReordering="true">
    <GridPageSettings PageSize="5"></GridPageSettings>
    <GridEvents CommandClicked="OnCommandClicked"
    TValue="HelpDeskTicket">
    </GridEvents>
    <GridColumns>
    <GridColumn HeaderText="" TextAlign="TextAlign.Left" Width="150">
    <GridCommandColumns>
    <GridCommandColumn Type=CommandButtonType.Edit
    ButtonOption="@(new CommandButtonOptions()
    { Content = "Edit" })">
    </GridCommandColumn>
    <GridCommandColumn Type=CommandButtonType.Delete
    ButtonOption="@(new CommandButtonOptions()
    { Content = "Delete" })">
    </GridCommandColumn>
    </GridCommandColumns>
    </GridColumn>
    <GridColumn IsPrimaryKey="true" Field=@nameof(HelpDeskTicket.Id)
    HeaderText="ID #" TextAlign="@TextAlign.Left"
    Width="70">
    </GridColumn>
    <GridColumn Field=@nameof(HelpDeskTicket.TicketStatus)
    HeaderText="Status" TextAlign="@TextAlign.Left"
    Width="80">
    </GridColumn>
    <GridColumn Field=@nameof(HelpDeskTicket.TicketDate)
                HeaderText="Date" TextAlign="@TextAlign.Left"
                Width="80">
    </GridColumn>
    <GridColumn Field=@nameof(HelpDeskTicket.TicketDescription)
    HeaderText="Description" TextAlign="@TextAlign.Left"
    Width="150">
    </GridColumn>
    <GridColumn Field=@nameof(HelpDeskTicket.TicketRequesterEmail)
    HeaderText="Requester" TextAlign="@TextAlign.Left"
    Width="150">
    </GridColumn>
    </GridColumns>
    </SfGrid>
    </div>
    </div>

</AuthorizeView>
@code {
    [CascadingParameter]
    private Task<AuthenticationState> authenticationStateTask { get; set; }
    
    public IQueryable<HelpDeskTicket> colHelpDeskTickets { get; set; }
    private HelpDeskTicket SelectedTicket = new HelpDeskTicket();
    protected override void OnInitialized()
    {
    // GetHelpDeskTickets returns IQueryable that the
    // SfGrid will use to only pull records for the
    // page that is currently selected.
        colHelpDeskTickets = @Service.GetHelpDeskTickets();
    }
    public async void OnCommandClicked(
        CommandClickEventArgs<HelpDeskTicket> args)
    {
    // Code to be added later.
    }
    
}